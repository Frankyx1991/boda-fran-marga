<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Fran & Marga — 11/10/2025</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="stage">
    <header class="overlay">
      <h1>Fran &amp; Marga</h1>
      <p class="date">11/10/2025</p>
    </header>

    <nav class="controls">
      <button id="btnPhoto" class="btn">📷 Tomar foto</button>
      <button id="btnVideo" class="btn">🎥 Grabar vídeo</button>
      <button id="btnGallery" class="btn">🖼️ Subir desde galería</button>
    </nav>

    <input id="inPhoto"   type="file" accept="image/*"        capture="environment" hidden />
    <input id="inVideo"   type="file" accept="video/*"        capture="camcorder"   hidden />
    <input id="inGallery" type="file" accept="image/*,video/*" hidden />
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // URL de tu Apps Script (Drive uploader)
    const APPS_SCRIPT_URL =
      "https://script.google.com/macros/s/AKfycbwjFv7oIl0ae7ZJp54PuHrilCziwJKEzm-L963sNhF7E0vyDJ2eKjn9-6QAQIz3PcfjYQ/exec";

    const toast = (msg) => {
      const el = document.getElementById("toast");
      el.textContent = msg;
      el.classList.add("show");
      clearTimeout(window.__toastTimer);
      window.__toastTimer = setTimeout(() => el.classList.remove("show"), 3500);
    };

    async function uploadFile(file, folder) {
      if (!file) return;
      const maxMB = 25;
      if (file.size > maxMB * 1024 * 1024) {
        toast(`El archivo supera ${maxMB} MB.`);
        return;
      }

      const form = new FormData();
      form.append("file", file);
      form.append("folder", folder);

      toast("Subiendo… Por favor espera");

      try {
        const res = await fetch(APPS_SCRIPT_URL, { method: "POST", body: form });
        try {
          const data = await res.json();
          if (!data.ok) throw new Error(data.error || "Error");
        } catch (_) {}
        toast("¡Gracias por compartir este momento con nosotros 💖!");
      } catch (err) {
        console.error(err);
        toast("Error al subir. Vuelve a intentarlo.");
      }
    }

    const inPhoto = document.getElementById("inPhoto");
    const inVideo = document.getElementById("inVideo");
    const inGallery = document.getElementById("inGallery");

    document.getElementById("btnPhoto").onclick = () => inPhoto.click();
    document.getElementById("btnVideo").onclick = () => inVideo.click();
    document.getElementById("btnGallery").onclick = () => inGallery.click();

    inPhoto.onchange = (e) => uploadFile(e.target.files[0], "fotos");
    inVideo.onchange = (e) => uploadFile(e.target.files[0], "videos");
    inGallery.onchange = (e) => uploadFile(e.target.files[0], "galeria");
  </script>
</body>
</html>