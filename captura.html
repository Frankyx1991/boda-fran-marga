<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Comparte tus recuerdos ‚Äì Boda Fran & Marga</title>

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet" />

<style>
  html, body { height:100%; margin:0; }
  body{
    min-height:100dvh;
    display:grid;
    grid-template-rows:auto 1fr auto;
    color:#fff;
    font-family:'Playfair Display', serif;
    position:relative;
    overflow-x:hidden;
    text-align:center;
  }
  body::before{
    content:"";
    position:fixed; inset:0;
    background:url("./assets/fondo.jpg?v=1") center center / cover no-repeat;
    z-index:-1;
  }
  header, footer{
    width:100%;
    padding:20px 12px;
    background:linear-gradient(to bottom, rgba(0,0,0,.35), rgba(0,0,0,0));
  }
  footer{
    background:linear-gradient(to top, rgba(0,0,0,.28), rgba(0,0,0,0));
  }
  h1{
    font-family:'Great Vibes', cursive;
    font-size:clamp(36px, 8vw, 72px);
    margin:0;
    text-shadow:2px 2px 10px rgba(0,0,0,.55);
  }
  .fecha{ opacity:.95; margin-top:6px; font-size:clamp(16px,2.8vw,22px); text-shadow:1px 1px 8px rgba(0,0,0,.45); }

  main{
    width:100%;
    display:flex; align-items:center; justify-content:center;
    padding:16px;
  }
  .card{
    width:min(720px, 92vw);
    background:rgba(0,0,0,.55);
    border:1px solid rgba(255,255,255,.2);
    border-radius:20px;
    backdrop-filter: blur(6px);
    padding:18px;
    text-align:left;
  }
  .controls{
    display:grid; gap:10px;
    grid-template-columns:1fr; margin-top:14px;
  }
  @media (min-width:680px){
    .controls{ grid-template-columns:1fr 1fr 1fr; }
  }
  .btn{
    padding:12px 18px;
    border:none; border-radius:12px;
    background:#ffffff; color:#222;
    font-size:16px; cursor:pointer;
    box-shadow:0 6px 18px rgba(0,0,0,.18);
  }
  .btn:disabled{ opacity:.6; cursor:not-allowed }
  details{
    margin-top:12px; background:rgba(255,255,255,.08);
    border:1px solid rgba(255,255,255,.2);
    border-radius:12px; padding:10px 12px;
  }
  label{ font-weight:700; display:block; margin:10px 0 6px }
  input[type="url"], input[type="password"], input[type="text"]{
    width:100%; padding:10px; border-radius:10px;
    border:1px solid rgba(255,255,255,.25);
    background:rgba(0,0,0,.35); color:#fff; outline:none;
  }
  .status{ margin-top:10px; min-height:20px; font-size:14px }
  .results{ margin-top:10px; padding-left:18px; max-height:32vh; overflow:auto }
  .results li{ margin:6px 0; word-break:break-all }
  .footer-links a{ color:#fff; text-decoration:underline; }
</style>
</head>
<body>
  <header>
    <h1>Fran &amp; Marga</h1>
    <div class="fecha">11/10/2025</div>
  </header>

  <main>
    <section class="card" aria-label="captura">
      <p style="margin:0 0 8px 0">Comparte tus recuerdos con nosotros üíû</p>

      <!-- Controles principales -->
      <div class="controls">
        <button id="btnFoto" class="btn">Subir foto</button>
        <button id="btnVideo" class="btn">Subir video</button>
        <button id="btnGaleria" class="btn">Subir desde galer√≠a</button>
      </div>

      <!-- Estado y resultados -->
      <div id="status" class="status"></div>
      <ul id="results" class="results"></ul>

      <!-- Configuraci√≥n (se guarda en localStorage) -->
      <details id="cfgBox">
        <summary>Configuraci√≥n (endpoint, token y √°lbum)</summary>
        <label for="endpoint">Endpoint (Apps Script Web App /exec)</label>
        <input id="endpoint" type="url" placeholder="https://script.google.com/macros/s/XXXXX/exec" />

        <label for="secret">Token de seguridad</label>
        <input id="secret" type="password" placeholder="Tu token secreto (p. ej. FranMarga2025)" />

        <label for="album">√Ålbum (p. ej. mesa-queen, ceremonia)</label>
        <input id="album" type="text" placeholder="Opcional: subcarpeta en Drive" />

        <div style="margin-top:10px">
          <button id="btnGuardarCfg" class="btn">Guardar configuraci√≥n</button>
        </div>
      </details>

      <!-- Inputs ocultos (c√°mara / galer√≠a) -->
      <input id="pickFoto" type="file" accept="image/*" capture="environment" style="display:none" />
      <input id="pickVideo" type="file" accept="video/*" capture="environment" style="display:none" />
      <input id="pickGaleria" type="file" accept="image/*,video/*" style="display:none" />
    </section>
  </main>

  <footer>
    <div class="footer-links">
      <a href="./index.html">Volver a portada</a>
    </div>
  </footer>

  <script src="./uploader.js"></script>
  <script>
    // Inicializa textos y eventos de los 3 botones
    window.addEventListener('DOMContentLoaded', () => {
      const $ = (sel) => document.querySelector(sel);
      const btnFoto = $('#btnFoto');
      const btnVideo = $('#btnVideo');
      const btnGaleria = $('#btnGaleria');

      const pickFoto = $('#pickFoto');
      const pickVideo = $('#pickVideo');
      const pickGaleria = $('#pickGaleria');

      // Cargar configuraci√≥n previa
      const endpoint = localStorage.getItem('endpoint') || '';
      const secret = localStorage.getItem('secret') || '';
      const album  = localStorage.getItem('album')  || '';

      if (endpoint) document.getElementById('endpoint').value = endpoint;
      if (secret)   document.getElementById('secret').value = secret;
      if (album)    document.getElementById('album').value  = album;

      // Guardar configuraci√≥n
      document.getElementById('btnGuardarCfg').addEventListener('click', () => {
        const ep = document.getElementById('endpoint').value.trim();
        const sc = document.getElementById('secret').value.trim();
        const al = document.getElementById('album').value.trim();
        if (!ep || !sc) {
          alert('Rellena endpoint y token.');
          return;
        }
        localStorage.setItem('endpoint', ep);
        localStorage.setItem('secret', sc);
        localStorage.setItem('album', al);
        alert('Configuraci√≥n guardada.');
      });

      // Handlers: abren selectores apropiados
      btnFoto.addEventListener('click', () => pickFoto.click());
      btnVideo.addEventListener('click', () => pickVideo.click());
      btnGaleria.addEventListener('click', () => pickGaleria.click());

      // Al seleccionar archivo ‚Üí subir autom√°ticamente
      const handlePicked = async (input) => {
        if (!input.files || !input.files.length) return;
        const file = input.files[0];
        await window.POVUploader.uploadSingle(file); // definido en uploader.js
        input.value = ''; // limpiar selecci√≥n para permitir repetir
      };

      pickFoto.addEventListener('change', () => handlePicked(pickFoto));
      pickVideo.addEventListener('change', () => handlePicked(pickVideo));
      pickGaleria.addEventListener('change', () => handlePicked(pickGaleria));
    });
  </script>
</body>
</html>