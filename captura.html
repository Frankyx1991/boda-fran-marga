<script>
// === CONFIG ===
const ENDPOINT = "https://script.google.com/macros/s/AKfycbzaPjbdwz_I1dj2ie7-iYxlpXtoCWn8oGEOEp89UoSOWUZSbquZeE5sHu07tnPnNnCHug/exec";
const ALBUM    = "Boda Fran & Marga";

// --- Subida SIEMPRE multipart ---
async function uploadMultipartStrict_(file){
  const fd = new FormData();
  fd.append("album", ALBUM);
  fd.append("file", file, file.name);

  // log visible para diagnóstico
  alert("Enviando multipart: " + file.name);

  const res = await fetch(ENDPOINT, { method: "POST", body: fd }); // sin headers → no hay preflight
  const txt = await res.text().catch(()=> "");
  let json = null; try { json = JSON.parse(txt); } catch {}

  if (!res.ok) {
    throw new Error(`HTTP ${res.status} ${res.statusText} → ${txt}`);
  }
  return json || { ok:false, error:"invalid_json", raw:txt };
}

async function uploadSingle(file){
  if (!file) return;
  try{
    const j = await uploadMultipartStrict_(file);
    if (j && j.ok) {
      alert("Subida correcta ✅");
    } else {
      alert(j?.error || "Error desconocido");
    }
  }catch(err){
    alert(err?.message || String(err));
  }
}
</script>